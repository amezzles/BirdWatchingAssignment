<!DOCTYPE html>
<html>
<head>
    <title>Bird Watching Game</title>
    <style>
        body { margin: 0; overflow: hidden; font-family: Monospace; background-color: #000; color: #fff; }
        canvas { width: 100%; height: 100%; }
        #info { position: absolute; top: 10px; width: 100%; text-align: center; }
    </style>
</head>
<body>
    <div id="info">
        <p>Take photos of birds<br>Left button to rotate the scene, scroll to zoom in/out</p>
    </div>

    <script type="module">
        import * as THREE from 'three';
        import { MTLLoader } from './jsm/loaders/MTLLoader.js';
        import { OBJLoader } from './jsm/loaders/OBJLoader.js';
        import { FirstPersonControls } from './jsm/controls/FirstPersonControls.js';
        import TerrainGenerator from './TerrainGenerator.js';

        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0x8FBCD4); // Light blue background

        const camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.set(0, 10, 0);
        camera.lookAt(new THREE.Vector3(0, 11, 10));

        const renderer = new THREE.WebGLRenderer();
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.outputEncoding = THREE.sRGBEncoding;
        renderer.gammaOutput = true;
        renderer.gammaFactor = 2.2;
        renderer.physicallyCorrectLights = true;
        renderer.toneMapping = THREE.ACESFilmicToneMapping;
        renderer.toneMappingExposure = 1.0;
        document.body.appendChild(renderer.domElement);

        // Lighting
        const ambientLight = new THREE.AmbientLight(0xf7b9a1, 0.3);
        scene.add(ambientLight);

        const directionalLight1 = new THREE.DirectionalLight(0xEE9B31, 0.4);
        directionalLight1.position.set(0, 0.2, -1);
        scene.add(directionalLight1);

        const directionalLight2 = new THREE.DirectionalLight(0xFF4B2B, 0.4);
        directionalLight2.position.set(0, 6, -10);
        scene.add(directionalLight2);

        const directionalLight3 = new THREE.DirectionalLight(0xFFDB25, 0.4);
        directionalLight3.position.set(0, 0.2, -10);
        scene.add(directionalLight3);

        // Terrain generation
        const terrainGenerator = new TerrainGenerator(scene);
        terrainGenerator.init();

        const fpControls = new FirstPersonControls(camera, renderer.domElement);
        fpControls.movementSpeed = 1;
        fpControls.lookSpeed = 0.015;

        function animate() {
            requestAnimationFrame(animate);
            fpControls.update(0.05);
            renderer.render(scene, camera);
        }

        animate();

        window.addEventListener('resize', () => {
            renderer.setSize(window.innerWidth, window.innerHeight);
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
        });
    </script>
</body>
</html>
